{% extends 'index.html' %}
{% load humanize %}

{% block title %}Ações Rentáveis{% endblock %}

{% block content %}

<meta charset="UTF-8">

<section class="d-flex bg-dark m-4 rounded flex-column"
    style="width: 94rem; height: 95vh; padding: 1rem; margin: 1.5rem;">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="text-white fw-bold">Lista de Ações</h2>
    <span class="badge bg-dark border border-secondary">{{ acoes|length }} Ativos Monitorados</span>
  </div>

  <div class="card bg-dark border-secondary shadow-lg">
    <div class="card-body p-0">
      {% if acoes %}
      <div class="table-responsive">
        <table class="table table-dark table-hover mb-0 align-middle">
          <thead class="bg-secondary text-white text-uppercase small">
            <tr>
              <th class="ps-4">Ticker</th>
              <th>Empresa</th>
              <th>Setor</th>
              <th class="text-end">Variação (7d)</th>
              <th class="text-center">Ações</th>
            </tr>
          </thead>
          <tbody class="border-top border-secondary">
            {% for acao in acoes %}
            <tr>
              <td class="ps-4">
                <a href="{% url 'detalhes_acao' acao.ticket %}" class="text-white fw-bold text-decoration-none">
                  {{ acao.ticket }}
                </a>
              </td>

              <td class="text-white">{{ acao.nome_empresa }}</td>

              <td>
                <span class="badge bg-secondary bg-opacity-50 text-light border border-secondary">
                  {{ acao.setor }}
                </span>
              </td>

              <td class="text-end fw-bold {% if acao.variacao < 0 %}text-danger{% else %}text-success{% endif %}">
                {% if acao.variacao is not None %}
                {% if acao.variacao < 0 %}▼{% else %}▲{% endif %} {{ acao.variacao|floatformat:2 }}% {% else %} <span
                  class="text-muted">—</span>
                  {% endif %}
              </td>

              <td class="text-center">
                <a href="{% url 'detalhes_acao' acao.ticket %}" class="btn btn-sm btn-outline-light"
                  title="Ver Detalhes">
                  <i class="bi bi-graph-up-arrow"></i> Ver
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <div class="p-5 text-center">
        <h3 class="text-muted">Nenhuma ação encontrada.</h3>
        <p class="text-muted">Adicione ativos ao seu banco de dados para começar.</p>
      </div>
      {% endif %}
    </div>
  </div>

</section>
{% endblock %}